<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>全部课程_IT/互联网|影视动漫|金融会计|职场能力_极视教育网</title>
    <meta name="description" content="极视教育作为中国领先的游戏职业在线教育平台之一,国内第一家专注于游戏职业培训与发展的在线 教育平台。平台致力于构建“学习+实战+机遇”三元结构闭环的模式，携手企业与名师一 起帮助有职业培训需求的人才，并为企业提供人才储备的解决方案,拥有海量高清职业课程,涵盖20+个技术领域,如Android,iOS ,Unity3D,Java,Photoshop,Maya,3D MAX,独立游戏等视频教程.根据在线学习特点,极视教育推出职业图谱,帮助学习者从零基础起步,结合实战案例演练,系统学习,助你快速成为优秀技术人才！">
    <meta name="keywords" content="极视教育,职业教育,在线教育平台,在线教育,在线学习,职业培训,android,ios,Unity3D,java,Photoshop,Maya,3D MAX,独立游戏">
    <meta name="viewport" content="width=device-width">

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

    <!-- <link rel="stylesheet" href="css/normalize.css"> -->
    <link rel="stylesheet" href="/css/main_cbf4c02.css">
    <style type="text/css">
        .midden-tab-menu .animation {transition: height .5s ease-out;-moz-transition: height .5s ease-out;-webkit-transition: height .5s ease-out;-o-transition: height .5s ease-out;transform-origin: center;-webkit-transform-origin: center;-ms-transform-origin: center;-moz-transform-origin: center;}
        .content-wrap *{box-sizing:border-box;-moz-box-sizing:border-box; /* Firefox */-webkit-box-sizing:border-box; /* Safari */}
        .content-wrap{margin:0 auto;width: 1200px;}
        .top-img-wrap{height: 200px;line-height: 200px;font-size: 38px;color: #fff;background: url('/img/info/setinfo/top-img-bg.png') no-repeat center center;background-size: cover;margin-bottom: 12px;}
        .midden-tab-menu ul{border-bottom: 1px solid #cecece;font-size: 16px;margin-bottom: 32px;}
        .midden-tab-menu ul>li{width: 66px;height: 46px;line-height: 46px;margin:0 50px 0 20px;text-align: center;}
        .midden-tab-menu ul>li.active{border-bottom: 3px solid #ff9001;color: #ff9001;height: 46px;}
        .midden-tab-menu ul>li.active a{color: #ff9001;}
        .midden-tab-menu ul>li:hover{border-bottom: 3px solid #ff9001;color: #ff9001;height: 46px;}
        .midden-tab-menu ul>li:hover a{color: #ff9001;}
        .midden-tab-menu ul>li:last-child{width: 80px;}
        .body-wrap{height: 442px;background: #fffdf7;box-shadow: 0 5px 6px 5px rgba(0,0,0,0.1);-moz-box-shadow: 0 5px 6px 2px rgba(0,0,0,0.1);margin-bottom: 90px;padding:42px 172px;}
         input{border:1px solid #cecece;height: 36px;vertical-align: middle;color: #666;border-radius: 3px;}
         input[type='text'],input[type='password']{padding-left: 15px;}
        .w430{width: 430px;}.w108{width: 108px;}
        .body-wrap ul>li{padding:25px 0;border-bottom: 1px solid #ededed;}
        .body-wrap ul>li .l-wrap{width: 81px;height: 52px;}
        .mrg-t25{margin-top: 25px;}.mrg-l52{margin-left: 52px;}.mrg-r8{margin-right: 8px;}.mrg-l85{margin-left: 85px;}
        .mrg-b16{margin-bottom: 16px;}.c3{color: #333;}.f16{font-size: 16px;}.cf1{color: #ff9001;}
        /*头像设置这一块*/
        .body-wrap .img-wrap{width: 180px;height: 180px;overflow: hidden;background: #eee;}
        .body-wrap .img-wrap img{width: 100%;height: 100%;}
        .body-wrap .btn-set{color: #333;width: 98px;height: 38px;cursor: pointer;background: inherit;margin-top: 22px;}
        .body-wrap .btn-set:hover{background: #f6f6f6;}
        /*sprite 样式*/
        .body-wrap .i-icon{background: url('/img/info/setinfo/icon.png') no-repeat;display: inline-block;vertical-align: middle;}
        .body-wrap .i-lock{background-position: -105px 3px;width: 42px;height: 52px;}
        .body-wrap .i-email{background-position: -150px 3px;width: 42px;height: 52px;}
        .body-wrap .i-tel{background-position: -198px 3px;width: 42px;height: 52px;}
        .body-wrap .i-wran{background-position: -245px -8px;width: 35px;height: 22px;}
        .body-wrap .i-completed{background-position: -463px -6px;}
        /*sprite 样式*/
        /*头像设置这一块*/

        /*设置密码*/
        /*弹框common样式*/
         .popbox *{box-sizing:border-box;-moz-box-sizing:border-box; /* Firefox */-webkit-box-sizing:border-box; /* Safari */}
        .popbox .i-icon{background: url('/img/info/setinfo/icon.png') no-repeat;display: inline-block;vertical-align: middle;width: 32px;height: 27px;}
        .btn-highlight{background: #ff9001;color: #fff;text-align: center;border:none;cursor: pointer;}
        .btn-gray{background: #bbbbbb;color: #fff;text-align: center;border:1px solid #bbbbbb;cursor: pointer;}
        .popbox{position: fixed;top: 50%;left: 50%;z-index: 88888;background: #fff;border-radius: 3px;}
        .popbox .title-wrap{font-size: 16px;background: #636974;color: #fff;position: relative;text-align: center;height: 42px;line-height: 42px;}
        .popbox .i-close{background-position:-253px -73px;position: absolute;top: 10px;right: 10px;cursor: pointer;}
        .popbox .midden-wrap{padding:18px 40px;}
        .popbox .bottom-wrap{margin-top: 10px;}
        .popbox .i-lock{background-position: -277px -8px;}
        .popbox .i-tick-lock{background-position: -306px -8px;}
        .popbox .i-tel{background-position: -433px -7px;}
        .popbox .i-img-code{background-position: -371px -9px;}
        .popbox .i-number-code{background-position: -400px -6px;}
        .popbox .i-tel-bound{width: 80px;height: 78px;background-position: 6px -72px;}
        .popbox .i-email-bound{width: 80px;height: 78px;background-position:-167px -66px;}
        .popbox .i-finger{width: 64px;height: 57px;background-position: -66px -72px;}
        .popbox .i-email{background-position: -339px -5px;}
        .popbox .btn-sure{width: 68px;height: 26px;}
        .popbox .btn-cancel{width: 68px;height: 26px;}
        /*弹框common样式*/
        /*设置密码*/
        .pwd-update-popbox{width: 412px;height: 216px;margin-left: -206px;margin-top: -108px;}
        .pwd-update-popbox input[type="text"],.pwd-update-popbox input[type="password"]{height: 30px;width: 282px;margin-left: 10px;}
        .pwd-update-popbox .err{top: 3px;right: 8px;}
        .relative-wrap{position: relative;}
         /*设置密码*/
         /*设置手机、邮箱*/
         .account-update-popbox{width: 412px;height: 264px;margin-left: -206px;margin-top: -182px;}
         body .h258{height: 258px;}
         .account-update-popbox .tac{text-align: center;}
         .account-update-popbox input[type="text"]{height: 30px;width: 198px;margin-left: 6px;}
         body .account-update-popbox .w288{width: 288px;}
         .account-update-popbox .yzm_img{width: 62px;height: 32px;}
         .account-update-popbox .btn-get-vericode{width: 78px;height: 32px;margin-left: 6px;}
         .account-update-popbox .account-wrap .err{right: 6px;top: 3px;}
         .account-update-popbox .err{right: 96px;}
         .account-update-popbox .veri-pwd-wrap .err{right: 19px;top: 6px;}
         .account-update-popbox .bc{display: block;margin:0 auto;}
        .mrg-l121{margin-left: 121px;}.mrg-l28{margin-left: 28px;}.bd2{border:1px solid #da8a82;}
        

    </style>
</head>
<body>
<div class="" include="/view/module/header.html"></div>
<div class="top-img-wrap">
    <div class="content-wrap">个人设置</div>
</div>
<div class="content-wrap">
    <div class="midden-tab-menu"><ul class="clearfix"><li class="f-l  animation"><a href="/view/info/setinfo.html">个人信息</a></li><li class="f-l animation active"><a href="/view/info/account_safe.html">账户安全</a></li><li class="f-l animation"><a href="/view/info/th_bind.html">绑定第三方</a></li></ul></div>
    <div class="body-wrap j_body_wrap">
        <ul>
            <li class="j_loading" style="line-height:336px;text-align:center;border:none;">数据加载中...</li>
            <li class="clearfix j_pwd_set_item" style="display:none;">
                <div class="f-l l-wrap"><i class="i-icon i-lock"></i></div>
                <div class="f-l">
                    <div class="mrg-b16">
                        <span class="c3 f16">账户密码</span>
                        <span><i class="i-icon i-wran"></i>未设置</span>
                    </div>
                    <div>用于保护账户信息与登陆安全，建议立即设置</div>
                </div>
                <div class="f-r"><input type="button" class="btn-set j_btn_popup_pwdset" value="设置"></div>
            </li>
            <li class="clearfix j_pwd_update_item" style="display:none;">
                <div class="f-l l-wrap"><i class="i-icon i-lock"></i></div>
                <div class="f-l">
                    <div class="mrg-b16">
                        <span class="c3 f16">账户密码</span>
                        <span><i class="i-icon i-completed"></i></span>
                    </div>
                    <div>用于保护账户信息与登陆安全</div>
                </div>
                <div class="f-r"><input type="button" class="btn-set j_btn_popup_pwdupdate" value="修改"></div>
            </li>
            <li class="clearfix j_email_set_item" style="display:none;">
                <div class="f-l l-wrap"><i class="i-icon i-email"></i></div>
                <div class="f-l">
                    <div class="mrg-b16">
                        <span class="c3 f16">邮箱</span>
                        <span><i class="i-icon i-wran"></i>未设置</span>
                    </div>
                    <div>邮箱可以登录极视教育与重置密码，建议立即设置</div>
                </div>
                <div class="f-r"><input type="button" data-value="0" data-type="0" class="btn-set j_btn_update" value="设置"></div>
            </li>
            <li class="clearfix j_email_update_item" style="display:none;">
                <div class="f-l l-wrap"><i class="i-icon i-email"></i></div>
                <div class="f-l">
                    <div class="mrg-b16">
                        <span class="c3 f16">邮箱</span>
                        <span class="cf1 j_email">1050964184@qq.com</span>
                    </div>
                    <div>手机可以登录极视教育与重置密码</div>
                </div>
                <div class="f-r"><input type="button" data-value="1" data-type="0" class="btn-set j_btn_update" value="修改"></div>
            </li>
            <li class="clearfix j_tel_set_item" style="display:none;">
                <div class="f-l l-wrap"><i class="i-icon i-tel"></i></div>
                <div class="f-l">
                    <div class="mrg-b16">
                        <span class="c3 f16">手机</span>
                        <span><i class="i-icon i-wran"></i>未设置</span>
                    </div>
                    <div>手机可以登录极视教育与重置密码，建议立即设置</div>
                </div>
                <div class="f-r"><input type="button" data-value="0" data-type="1" class="btn-set j_btn_update" value="设置"></div>
            </li>
            <li class="clearfix j_tel_update_item" style="display:none;">
                <div class="f-l l-wrap"><i class="i-icon i-tel"></i></div>
                <div class="f-l">
                    <div class="mrg-b16">
                        <span class="c3 f16">手机</span>
                       <span class="cf1 j_tel">15214334028</span>
                    </div>
                    <div>手机可以登录极视教育与重置密码</div>
                </div>
                <div class="f-r"><input type="button" data-value="1" data-type="1" class="btn-set j_btn_update" value="修改"></div>
            </li>
        </ul>
    </div>
</div>
<div include="../module/footer.html"></div>
<div class="popbox pwd-update-popbox j_setpwd_popbox" style="display:none;">
    <div class="title-wrap">设置密码<i class="i-icon i-close j_close"></i></div>
    <div class="midden-wrap">
        <div class="mrg-b16"><i class="i-icon i-lock"></i><input type="password" class="j_pwd" placeholder="输入密码"></div>
        <div class="relative-wrap"><i class="i-icon i-tick-lock"></i><input type="password" class="j_confirm_pwd" placeholder="确认密码"><span class="err j_setpwd_err"></span></div>
    </div>
    <div class="bottom-wrap"><input type="button" class="btn-sure btn-highlight mrg-l121 j_sure_set_pwd" value="确定"><input type="button" class="btn-cancel btn-gray mrg-l28 j_close" value="取消"></div>
</div>
<div class="popbox pwd-update-popbox h258 j_updatepwd_popbox" style="display:none;">
    <div class="title-wrap">修改密码<i class="i-icon i-close j_close"></i></div>
    <div class="midden-wrap">
        <div class="mrg-b16 relative-wrap">
            <i class="i-icon i-lock"></i>
            <input type="password" class="j_pwd" placeholder="输入原密码">
            <span class="err j_pwd_err"></span>
        </div>
        <div class="mrg-b16 relative-wrap">
            <i class="i-icon i-lock"></i>
            <input type="password" class="j_newpwd" placeholder="输入新密码">
            <span class="err j_newpwd_err"></span>
        </div>
        <div class="relative-wrap">
            <i class="i-icon i-tick-lock"></i>
            <input type="password" class="j_confirm_pwd" placeholder="确认密码">
            <span class="err j_confirm_pwd_err"></span>
        </div>
    </div>
    <div class="bottom-wrap"><input type="button" class="btn-sure btn-highlight mrg-l121 j_sure_update_pwd" value="确定"><input type="button" class="btn-cancel btn-gray mrg-l28 j_close" value="取消"></div>
</div>
<div class="popbox account-update-popbox j_veri_pwd_popbox" style="display:none;">
    <div class="title-wrap">验证身份<i class="i-icon i-close j_close"></i></div>
    <div class="midden-wrap veri-pwd-wrap">
        <div class="mrg-b16 tac c3">请输入登陆密码验证身份<i class="i-icon i-finger"></i></div>
        <div class="relative-wrap"><i class="i-icon i-lock"></i><input type="password" class="w288 j_pwd" placeholder="输入密码"><span class="err j_pwd_err"></span></div>
    </div>
    <div class="bottom-wrap"><input type="button" class="btn-sure btn-highlight mrg-l121 j_btn_sure" value="确定"><input type="button" class="btn-cancel btn-gray mrg-l28 j_close" value="取消"></div>
</div>
<div class="popbox account-update-popbox j_update_tel_popbox" style="display:none;">
    <div class="title-wrap"><span class="j_title_type">设置</span>手机<i class="i-icon i-close j_close"></i></div>
    <div class="midden-wrap ">
        <div class="mrg-b16 relative-wrap account-wrap">
            <i class="i-icon i-tel"></i>
            <input type="text" class="w288 j_tel" placeholder="输入手机号">
            <span class="err j_tel_err" style="display:none;"></span>
        </div>
        <div class="relative-wrap mrg-b16">
            <i class="i-icon i-img-code"></i>
            <input type="text" class="j_img_code" placeholder="输入验证码">
            <img align="absmiddle" src="" class="yzm_img" title="">
            <a data-url="#" href="javascript:" style="color: Gray" class="yzm_a">
                <img src="/img/login/refls.png" style="margin:0" alt="">
            </a>
            <span class="err j_img_code_err" style="display:none;"></span>
        </div>
        <div class="relative-wrap">
            <i class="i-icon i-number-code"></i>
            <input type="text" class="j_vericode" placeholder="请输入手机验证码">
            <input type="button" class="btn-highlight btn-get-vericode j_btn_get_vericode" value="获取验证码">
            <span class="err j_vericode_err" style="display:none;"></span></div>
    </div>
    <div class="bottom-wrap">
        <input type="button" class="btn-sure btn-highlight mrg-l121 j_btn_sure_update" value="确定">
        <input type="button" class="btn-cancel btn-gray mrg-l28 j_close" value="取消">
    </div>
</div>
<div class="popbox account-update-popbox j_update_email_popbox" style="display:none;">
    <div class="title-wrap"><span class="j_title_type">设置</span>邮箱<i class="i-icon i-close j_close"></i></div>
    <div class="midden-wrap ">
        <div class="mrg-b16 relative-wrap account-wrap">
            <i class="i-icon i-email"></i>
            <input type="text" class="w288 j_email" placeholder="输入邮箱">
            <span class="err j_email_err" style="display:none;"></span>
        </div>
        <div class="relative-wrap mrg-b16">
            <i class="i-icon i-img-code"></i>
            <input type="text" class="j_img_code" placeholder="输入验证码">
            <img align="absmiddle" src="" class="yzm_img" title="">
            <a data-url="#" href="javascript:" style="color: Gray" class="yzm_a">
                <img src="/img/login/refls.png" style="margin:0" alt="">
            </a>
            <span class="err j_img_code_err" style="display:none;"></span>
        </div>
        <div class="relative-wrap">
            <i class="i-icon i-number-code"></i>
            <input type="text" class="j_vericode" placeholder="请输入邮箱验证码">
            <input type="button" class="btn-highlight btn-get-vericode j_btn_get_vericode" value="获取验证码">
            <span class="err j_vericode_err" style="display:none;"></span></div>
    </div>
    <div class="bottom-wrap">
        <input type="button" class="btn-sure btn-highlight mrg-l121 j_btn_sure_update" value="确定">
        <input type="button" class="btn-cancel btn-gray mrg-l28 j_close" value="取消">
    </div>
</div>
<div class="popbox account-update-popbox j_tel_success_popbox" style="display:none;">
    <div class="title-wrap"><span class="j_title_type"></span>手机<i class="i-icon i-close"></i></div>
    <div class="midden-wrap">
        <div class="mrg-b16 tac c3"><i class="i-icon i-tel-bound"></i></div>
        <div class="tac">手机<span class="j_type_str"></span>成功！</div>
        <div class="tac">你可以通过<span class="j_account"></span>登录极视教育</div>
    </div>
    <div class="bottom-wrap"><input type="button" class="btn-sure btn-highlight bc j_close" value="确定"></div>
</div>
<div class="popbox account-update-popbox j_email_success_popbox" style="display:none;">
    <div class="title-wrap"><span class="j_title_type"></span>邮箱<i class="i-icon i-close"></i></div>
    <div class="midden-wrap">
        <div class="mrg-b16 tac c3"><i class="i-icon i-email-bound"></i></div>
        <div class="tac">邮箱<span class="j_type_str"></span>成功！</div>
        <div class="tac">你可以通过<span class="j_account"></span>登录极视教育</div>
    </div>
    <div class="bottom-wrap"><input type="button" class="btn-sure btn-highlight bc j_close" value="确定"></div>
</div>
<script src="/js/vendor/jquery-1.11.3.min_6163309.js"></script>
<script type="text/javascript" src="/js/main_c5f7d4a.js"></script>
<script type="text/javascript">
    var asModule={
        bindEvents:function(){
            var self=this;
            $('body').on('focus','input',function(){
                var $this=$(this);
                self.inputBlurHide($this);
            });
            // $('body').on('blur','input',function(){
            //     var $this=$(this);
            //     self.inputFocusShow($this);
            // });
            $('body').on('click','.j_close',function(){
                var $this=$(this),$wrap=$this.closest('.popbox');
                self.closePopbox($this);
                self.clearState($wrap);
            });
            $('.j_body_wrap').on('click','.j_btn_popup_pwdset',function(){
                $('.j_global_bg').show();
                $('.j_setpwd_popbox').show();
            });
            $('.j_body_wrap').on('click','.j_btn_popup_pwdupdate',function(){
                $('.j_global_bg').show();
                $('.j_updatepwd_popbox').show();
            });
            $('.j_setpwd_popbox').on('click','.j_sure_set_pwd',function(){
                var $j_wrap=$('.j_setpwd_popbox'),
                    pwd=$j_wrap.find('.j_pwd').val(),
                    confirmpwd=$j_wrap.find('.j_confirm_pwd').val();
                if(!self.checkPwd(pwd,confirmpwd)){
                    $('.j_setpwd_err').html('密码为空或不一致').fadeIn();
                    return;
                }
                $.ajax({
                    type:'post',
                    data:{password:pwd,confirmPassword:confirmpwd},
                    url:mainModule.uri.setPwd,
                    success:function(result){
                        mainModule.log('设置密码接口返回数据',result);
                        mainModule.httpInterceptor(result,function(result){
                            mainModule.showGlobalHintBar('密码设置成功');
                            $('.j_pwd_set_item').hide();
                            $('.j_pwd_update_item').show();
                            $j_wrap.find('.j_close').trigger('click');

                        },function(result){
                            mainModule.showGlobalHintBar(result.message);
                        })
                    }
                })
            });
            $('.j_updatepwd_popbox').on('click','.j_sure_update_pwd',function(){
                var $this=$(this),
                    $wrap=$('.j_updatepwd_popbox'),
                    $j_as_oldpwd=$wrap.find('.j_pwd'),
                    $j_as_newpwd=$wrap.find('.j_newpwd'),
                    $j_as_confirm_newpwd=$wrap.find('.j_confirm_pwd'),
                    pwd=$j_as_oldpwd.val(),
                    newPwd=$j_as_newpwd.val(),
                    confirmNewPwd=$j_as_confirm_newpwd.val();
                console.log(pwd);
                if(!self.checkPwd(newPwd,confirmNewPwd)){
                    $wrap.find('.j_confirm_pwd_err').html('密码为空或不一致').show();
                    return;
                }
                $wrap.find('.err').hide();
                self.updatePwd(pwd,newPwd,confirmNewPwd,function(result){
                    self.clearState($wrap);
                    self.closePopbox($this);
                    mainModule.showGlobalHintBar('密码修改成功！');
                },function(result){
                     // mainModule.showGlobalHintBar(result.message);
                     self.dealWithErr(result.content,$wrap);
                });
            });
            //手机设置或修改按钮事件
            $('.j_body_wrap').on('click','.j_btn_update',function(){
                var $this=$(this),value=$this.data('value'),type=$this.data('type');
                $('.j_veri_pwd_popbox').show();
                $('.j_global_bg').show();
                //value:0未绑定,1已绑定;type:0绑定邮箱,1绑定手机
                self.accountType=type;
                self.accountValue=value;
            });
            // 确认身份密码事件
            $('.j_veri_pwd_popbox').on('click','.j_btn_sure',function(){
                var $wrap=$('.j_veri_pwd_popbox'),pwd=$wrap.find('.j_pwd').val();
                self.confirmPwd(pwd,function(result){
                    console.log(result);
                    if(typeof result=='object'&&!result.content){
                        $wrap.find('.j_pwd_err').html('密码不正确').show();
                        return;
                    }
                    $wrap.find('.j_pwd_err').hide();
                    self.refreshVeriCode();
                    $wrap.find('.j_pwd').val('');
                    $wrap.hide();
                    if(self.accountType){
                        // 修改手机
                        if(self.accountValue){
                            $('.j_update_tel_popbox').show();
                            return;
                        }
                        // 绑定手机
                        $('.j_update_tel_popbox').show();
                        return;
                    }
                    // 修改邮箱
                    if(self.accountValue){
                        $('.j_update_email_popbox').show();
                        return;
                    }
                    // 绑定邮箱
                    $('.j_update_email_popbox').show();
                    return;

                },function(result){
                    self.dealWithErr(result.content,$wrap);
                });
            });
            $('body').on('click','.j_btn_get_vericode',function(){
                mainModule.disableBtn($(this));
                if(self.accountType==1){
                    var $wrap=$('.j_update_tel_popbox');
                    if(!self.testTel()||!self.testImgCode($wrap)){
                        return;
                    }
                    self.refreshVeriCode();
                    asModule.sendTelCode($wrap,function(){
                        self.timing($wrap);
                   },function(result){
                        self.dealWithUpdateErr(result,$wrap);
                   });
                }else{
                    var $wrap=$('.j_update_email_popbox');
                    if(!self.testEmail()||!self.testImgCode($wrap)){
                        return;
                    }
                    self.refreshVeriCode();
                   asModule.sendEmailCode($wrap,function(){
                        self.timing($wrap);
                   },function(result){
                        self.dealWithUpdateErr(result,$wrap);
                   });
                }
            });
            // 确认修改事件
            $('body').on('click','.j_btn_sure_update',function(){
                var $this=$(this),$wrap=$this.closest('.popbox'),
                    vericode=$wrap.find('.j_vericode').val();
                self.updateAccount=account;
                if(self.accountType==1){
                    // 修改或绑定手机
                    if(!self.testTel()){
                        return;
                    }
                    var account=$wrap.find('.j_tel').val();
                    self.updateTel(account,vericode,function(){
                        $wrap.hide();
                        self.switchToSuccessPopbox(account);
                    },function(result){
                        self.dealWithUpdateErr(result,$wrap);
                    })
                }else{
                    // 修改或绑定手机
                    if(!self.testEmail()){
                        return;
                    }
                    var account=$wrap.find('.j_email').val();
                    
                    self.updateEmail(account,vericode,function(){
                        $wrap.hide();
                        self.switchToSuccessPopbox(account);
                    },function(result){
                        self.dealWithUpdateErr(result,$wrap);
                    })
                }
            });
        },
        clearState:function($wrap){
            $wrap.find('input[type="text"]').val('');
            $wrap.find('input[type="password"]').val('');
            $wrap.find('.err').html('').hide();
        },
        dealWithUpdateErr:function(result,$wrap){
            var errArr=result.content||[];
            for(var i=0,ii=errArr.length;i<ii;i++){
                var item=errArr[i];
                switch(item.field){
                    case 'email':
                        $wrap.find('.j_email_err').html(item.message).show();
                    break;
                    case 'emailCaptcha':
                        $wrap.find('.j_vericode_err').html(item.message).show();
                    break;
                    case 'mobilephone':
                        $wrap.find('.j_tel_err').html(item.message).show();
                    break;
                    case 'smsCaptcha':
                        $wrap.find('.j_vericode_err').html(item.message).show();
                    break;
                    case 'captcha':
                        $wrap.find('.j_img_code_err').html(item.message).show();
                    break;
                }
            }
            if(!result.content){
                if(this.accountType){
                    $wrap.find('.j_tel_err').html(result.message).show();
                    return;
                }
                $wrap.find('.j_email_err').html(result.message).show();
            }
        },
        switchToSuccessPopbox:function(account){
            var $wrap=$('.j_tel_success_popbox');
            var title_type='设置',typestr='绑定';
            if(!this.accountType){
                //邮箱绑定或修改
                $wrap=$('.j_email_success_popbox');
                $('.j_email_update_item').find('.j_email').html(account);
                if(!this.accountValue){
                    // 如果是邮箱绑定
                    $('.j_email_set_item').hide();
                    $('.j_email_update_item').show();
                }
            }else{
                //手机绑定或修改
                $('.j_tel_update_item').find('.j_tel').html(account);
                if(!this.accountValue){
                    //如果是手机绑定
                    $('.j_tel_set_item').hide();
                    $('.j_tel_update_item').show();
                }
            }
            if(this.accountValue){
                title_type=typestr='修改';
            }
            $wrap.find('.j_title_type').html(title_type);
            $wrap.find('.j_type_str').html(typestr);
            $wrap.find('.j_account').html(account)
            $wrap.show();

        },
        refreshVeriCode:function(){
            $('.yzm_img').attr('src',mainModule.uri.getVeriCodeImg+'?'+Math.random());
        },
        dealWithErr:function(result,$wrap){
            var errArr=result||[];
            for(var i=0,ii=errArr.length;i<ii;i++){
                var item=errArr[i];
                switch(item.field){
                    case 'newPassword':
                        $wrap.find('.j_newpwd_err').html(item.message).show();
                    break;
                    case 'confirmPassword':
                        $wrap.find('.j_confirm_pwd_err').html(item.message).show();
                    break;
                    case 'password':
                        $wrap.find('.j_pwd_err').html(item.message).show();
                    break;
                }
            }
            if(!result.content){
                $wrap.find('.j_pwd_err').html(result.message).show();
            }
        },
        confirmPwd:function(pwd,succFunc,failFunc){
            $.ajax({
                type:'get',
                data:{password:pwd},
                url:mainModule.uri.confirmPwd,
                success:function(result){
                    mainModule.log('确认密码',result);
                    mainModule.httpInterceptor(result,succFunc,failFunc);
                }
            })
        },
        sendEmailCode:function($wrap,succFunc,failFunc){
            var captcha=$wrap.find('.j_img_code').val();
            $.ajax({
                type:'get',
                data:{email:$wrap.find('.j_email').val(),captcha:captcha},
                url:mainModule.uri.sendEmailCode,
                success:function(result){
                    mainModule.log('发送email验证码结果',result);
                    mainModule.httpInterceptor(result,succFunc,failFunc);
                }
            })
        },
        sendTelCode:function($wrap,succFunc,failFunc){
            var captcha=$wrap.find('.j_img_code').val();
            $.ajax({
                type:'get',
                data:{mobilephone:$wrap.find('.j_tel').val(),"business":3,"captcha":captcha},
                url:mainModule.uri.sendTelCodeIncludeVeri,
                success:function(result){
                    mainModule.log('发送Tel验证码结果',result);
                    console.log(result);
                    mainModule.httpInterceptor(result,succFunc,failFunc);
                }
            })
        },
        updateTel:function(tel,vericode,succFunc,failFunc){
            $.ajax({
                type:'post',
                data:{mobilephone:tel,smsCaptcha:vericode},
                url:mainModule.uri.updateTel,
                success:function(result){
                    mainModule.log('修改手机号码',result);
                    mainModule.httpInterceptor(result,succFunc,failFunc);
                }
            })
        },
        updateEmail:function(email,vericode,succFunc,failFunc){
            $.ajax({
                type:'post',
                data:{email:email,emailCaptcha:vericode},
                url:mainModule.uri.updateEmail,
                success:function(result){
                    mainModule.log('修改email',result);
                    mainModule.httpInterceptor(result,succFunc,failFunc);
                }
            })
        },
        closePopbox:function($this){
            $this.closest('.popbox').hide();
            $('.j_global_bg').hide();
        },
        updatePwd:function(password,newPassword,confirmPassword,succFunc,failFunc){
            var self=this;
            $.ajax({
                type:'post',
                data:{password:password,newPassword:newPassword,confirmPassword:confirmPassword},
                url:mainModule.uri.updatePwd,
                success:function(result){
                    mainModule.log('修改密码接口',result)
                    mainModule.httpInterceptor(result,succFunc,failFunc);
                }
            })
        },
        toggleShowSetOrUpdatePwd:function(info){
            $('.j_loading').hide();
            var info=mainModule.userInfo;
            info.hasPassword?($('.j_pwd_update_item').show()):($('.j_pwd_set_item').show());
            info.mobilephone?(
                $('.j_tel_update_item').show(),
                $('.j_tel_update_item').find('.j_tel').html(info.mobilephone),
                $('.j_update_tel_popbox').find('.j_title_type').html('修改')
                ):($('.j_tel_set_item').show());
            info.email?(
                $('.j_email_update_item').show(),
                $('.j_email_update_item').find('.j_email').html(info.email),
                $('.j_update_email_popbox').find('.j_title_type').html('修改')
                ):($('.j_email_set_item').show());
        },
        checkPwd:function(pwd,confirmpwd){
            if(pwd==''||!(pwd==confirmpwd)){
                return false;
            }
            return true;
        },
        count:60,
        timing:function($wrap){
            var self=this;
            var count=--self.count;
            $wrap.find('.j_btn_get_vericode').prop('disabled',true).val(count+"秒后重发");
            $wrap.find('.j_btn_get_vericode').css('background','#E0E0E0');
            if(count>1){
                var st=setTimeout(function(){
                    self.timing($wrap);
                },1000);
            }else
            {
                self.count=60;
                $wrap.find('.j_btn_get_vericode').prop('disabled',false).val("获取验证码");
                $wrap.find('.j_btn_get_vericode').css('background','#ff9015');
            }
        },
        passportReg:{
            pwd: /^.*[A-Za-z0-9_\.-]+.*$/,
            email: /^[A-Z_a-z0-9-\.]+@([A-Z_a-z0-9-]+\.)+[a-z0-9A-Z]{2,4}$/,
            phone: /^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0-9]|17[0-9])\d{8}$/,
        },
        testEmail:function(){
            var $wrap=$('.j_update_email_popbox'),email=$wrap.find('.j_email').val();
            if(email.trim()==''){
                $wrap.find('.j_email_err').html('请填写邮箱号码').show();
                return false;
            }
            if(!this.passportReg.email.test(email)){
                $wrap.find('.j_email_err').html('邮箱号码格式不正确').show();
                return false;
            }else{
                $wrap.find('.j_email_err').empty().hide();
                return true;
            }
        },
        testTel:function(){
            var $wrap=$('.j_update_tel_popbox'),
                tel=$wrap.find('.j_tel').val();
            if(tel.trim()==''){
                $wrap.find('.j_tel_err').html('请填写手机号码').show();
                return false;
            }
            if(!this.passportReg.phone.test(tel)){
                $wrap.find('.j_tel_err').html('手机号码格式不正确').show();
                return false;
            }else{
                $wrap.find('.j_tel_err').empty().hide();
                return true;
            }
        },
        testImgCode:function($wrap){
            var imgCode=$wrap.find('.j_img_code').val();
            if(imgCode==''){
                $wrap.find('.j_img_code_err').html('请输入验证码').show();
                return false;
            }
            if(imgCode.length>4){
                $wrap.find('.j_img_code_err').html('验证码错误').show();
                return false;
            }
            $wrap.find('.j_img_code_err').html('').hide();
            return true;
        },
        inputBlurHide:function($input){
            var $err=$input.next('.err'),val=$err.html();
            if(val){
                $err.hide();
            }
        },
        inputFocusShow:function($input){
            var $err=$input.next('.err'),val=$err.html();
            if(val){
                $err.show();
            }
        },
        init:function(){
            this.bindEvents();
            var self=this;
            var si=setInterval(function(){
                if(mainModule.userInfo){
                    self.toggleShowSetOrUpdatePwd();
                    clearInterval(si);
                }
            },1000/60);
        }
    };
    asModule.init();
</script>
</body>
</html>


